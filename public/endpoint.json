{
    "name": "mandrill",
    "display": "Mandrill",
    "description": "Sends transactional emails using Mandrill",
    "help": "http://guides.spreecommerce.com/integration/endpoints/mandrill",
    "consumers": [
        {
            "name": "order_confirmation",
            "path": "/order_confirmation",
            "description": "Send order confirmation emails when new orders are placed.",
            "requires": {
                "parameters": [
                    {
                        "name": "api_key",
                        "description": "Mandrill API key",
                        "data_type": "string"
                    },
                    {
                        "name": "order_confirmation.from",
                        "description": "Reply-to address for email",
                        "data_type": "string"
                    },
                    {
                        "name": "order_confirmation.subject",
                        "description": "Subject of email",
                        "data_type": "string"
                    },
                    {
                        "name": "order_confirmation.template",
                        "description": "Mandrill template name",
                        "data_type": "string"
                    }
                ]
            },
            "recommends": {
                "messages": [
                    "order:new",
                    "order:update"
                ],
                "identifiers": {
                    "order_number": "payload.order.number"
                },
                "filters": [
                    {
                        "path": "payload.order.status",
                        "operator": "eq",
                        "value": "complete"
                    }
                ],
                "options": {
                    "retries_allowed": true
                }
            },
            "produces": {
                "messages": [
                    {
                        "message": "email:sent",
                        "schema": "/email.sent.json"
                    },
                    {
                        "message": "email:failure",
                        "schema": "/email.failure.json"
                    }
                ]
            }
        },
        {
            "name": "order_cancellation",
            "path": "/order_cancellation",
            "description": "Send order cancellation emails when orders are cancelled.",
            "requires": {
                "parameters": [
                    {
                        "name": "api_key",
                        "description": "Mandrill API key",
                        "data_type": "string"
                    },
                    {
                        "name": "order_cancellation.from",
                        "description": "Reply-to address for email",
                        "data_type": "string"
                    },
                    {
                        "name": "order_cancellation.subject",
                        "description": "Subject of email",
                        "data_type": "string"
                    },
                    {
                        "name": "order_cancellation.template",
                        "description": "Mandrill template name",
                        "data_type": "string"
                    }
                ]
            },
            "recommends": {
                "messages": [
                    "order:canceled"
                ],
                "identifiers": {
                    "order_number": "payload.order.number"
                },
                "options": {
                    "allow_retries": true
                }
            },
            "produces": {
                "messages": [
                    {
                        "message": "email:sent",
                        "schema": "/email.sent.json"
                    },
                    {
                        "message": "email:failure",
                        "schema": "/email.failure.json"
                    }
                ]
            }
        },
        {
            "name": "shipment_confirmation",
            "path": "/shipment_confirmation",
            "description": "Send shipment confirmation emails when shipments are dispatched.",
            "requires": {
                "parameters": [
                    {
                        "name": "api_key",
                        "description": "Mandrill API key",
                        "data_type": "string"
                    },
                    {
                        "name": "shipment_confirmation.from",
                        "description": "Reply-to address for email",
                        "data_type": "string"
                    },
                    {
                        "name": "shipment_confirmation.subject",
                        "description": "Subject of email",
                        "data_type": "string"
                    },
                    {
                        "name": "shipment_confirmation.template",
                        "description": "Mandrill template name",
                        "data_type": "string"
                    }
                ]
            },
            "recommends": {
                "messages": [
                    "shipment:confirmation"
                ],
                "identifiers": {
                    "order_number": "payload.order.number"
                },
                "options": {
                    "retries_allowed": true
                }
            },
            "produces": {
                "messages": [
                    {
                        "message": "email:sent",
                        "schema": "/email.sent.json"
                    },
                    {
                        "message": "email:failure",
                        "schema": "/email.failure.json"
                    }
                ]
            }
        }
    ]
}
